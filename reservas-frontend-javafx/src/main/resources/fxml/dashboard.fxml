<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.MenuButton?>
<?import javafx.scene.control.MenuItem?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.RowConstraints?>

<!--
  Dashboard Principal
  Sistema de Reservas - Municipalidad de Pérez Zeledón
  
  Estructura:
  - BorderPane (root)
    - Top: Navbar (72px)
    - Left: Sidebar (280px)
    - Center: ScrollPane con contenido
-->

<BorderPane fx:id="rootPane" prefWidth="1440.0" prefHeight="900.0" 
            styleClass="border-pane-root"
            stylesheets="@../styles.css"
            xmlns="http://javafx.com/javafx/21" 
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="cr.una.reservas.frontend.ui.main.DashboardController">
    
    <!-- NAVBAR -->
    <top>
        <HBox alignment="CENTER_LEFT" spacing="16.0" prefHeight="72.0" styleClass="navbar">
            
            <!-- Logo -->
            <ImageView fx:id="navbarLogo" fitHeight="40.0" preserveRatio="true"/>
            
            <!-- Título -->
            <Label text="Sistema de Reservas" styleClass="navbar-title"/>
            
            <!-- Spacer -->
            <Region HBox.hgrow="ALWAYS"/>
            
            <!-- Botón Notificaciones -->
            <Button fx:id="notificationsButton" text="🔔" 
                    onAction="#handleNotifications"
                    styleClass="button-icon"/>
            
            <!-- Menú de Perfil -->
            <MenuButton fx:id="profileMenu" text="Mi Perfil" 
                        styleClass="profile-menu">
                <items>
                    <MenuItem text="Mi Perfil" onAction="#handleProfile"/>
                    <MenuItem text="Configuración" onAction="#handleSettings"/>
                    <MenuItem text="Cerrar Sesión" onAction="#handleLogout"/>
                </items>
            </MenuButton>
        </HBox>
    </top>
    
    <!-- SIDEBAR -->
    <left>
        <VBox spacing="0.0" prefWidth="280.0" styleClass="sidebar">
            
            <!-- User Info -->
            <VBox alignment="CENTER" spacing="8.0">
                <padding>
                    <Insets bottom="16"/>
                </padding>
                
                <!-- Avatar -->
                <ImageView fx:id="userAvatar" fitWidth="64.0" fitHeight="64.0" preserveRatio="true"
                           styleClass="sidebar-avatar"/>
                
                <!-- Nombre Usuario -->
                <Label fx:id="userNameLabel" text="Usuario" styleClass="sidebar-username"/>
                
                <!-- Rol -->
                <Label fx:id="userRoleLabel" text="Ciudadano" styleClass="badge, badge-info"/>
            </VBox>
            
            <Separator>
                <VBox.margin>
                    <Insets top="16" bottom="16"/>
                </VBox.margin>
            </Separator>
            
            <!-- Menu Items -->
            <VBox spacing="8.0">
                <Button fx:id="menuDashboard" text="📊 Dashboard" 
                        onAction="#navigateToDashboard"
                        styleClass="sidebar-item-active"
                        maxWidth="Infinity" alignment="CENTER_LEFT" prefHeight="48.0"
                        style="-fx-background-color: #dbeafe; -fx-text-fill: #004d99; -fx-font-weight: 600; -fx-background-radius: 8px; -fx-padding: 12px 16px; -fx-font-size: 15px;">
                </Button>
                
                <Button fx:id="menuEspacios" text="🏛️ Espacios" 
                        onAction="#navigateToEspacios"
                        styleClass="sidebar-item"
                        maxWidth="Infinity" alignment="CENTER_LEFT" prefHeight="48.0"/>
                
                <Button fx:id="menuReservas" text="📅 Mis Reservas" 
                        onAction="#navigateToMisReservas"
                        styleClass="sidebar-item"
                        maxWidth="Infinity" alignment="CENTER_LEFT" prefHeight="48.0"/>
                
                <Button fx:id="menuCalendario" text="📆 Calendario" 
                        onAction="#navigateToCalendario"
                        styleClass="sidebar-item"
                        maxWidth="Infinity" alignment="CENTER_LEFT" prefHeight="48.0"/>
                
                <Button fx:id="menuConfiguracion" text="⚙️ Configuración" 
                        onAction="#navigateToConfiguracion"
                        styleClass="sidebar-item"
                        maxWidth="Infinity" alignment="CENTER_LEFT" prefHeight="48.0"/>
            </VBox>
        </VBox>
    </left>
    
    <!-- CONTENT -->
    <center>
        <ScrollPane fitToWidth="true" fitToHeight="true" styleClass="content-area">
            <VBox spacing="32.0" styleClass="content-container">
                <padding>
                    <Insets top="32" right="32" bottom="32" left="32"/>
                </padding>
                
                <!-- Welcome Section -->
                <HBox alignment="CENTER_LEFT" spacing="16.0">
                    <VBox spacing="4.0" HBox.hgrow="ALWAYS">
                        <Label fx:id="welcomeLabel" text="¡Bienvenido de vuelta!" styleClass="text-h2"/>
                        <Label fx:id="dateLabel" text="Lunes, 21 de Octubre 2025" styleClass="text-body, text-muted"/>
                    </VBox>
                </HBox>
                
                <!-- Stats Grid -->
                <GridPane hgap="24.0" vgap="24.0">
                    <columnConstraints>
                        <ColumnConstraints percentWidth="25.0"/>
                        <ColumnConstraints percentWidth="25.0"/>
                        <ColumnConstraints percentWidth="25.0"/>
                        <ColumnConstraints percentWidth="25.0"/>
                    </columnConstraints>
                    
                    <!-- Stat 1: Total Reservas -->
                    <VBox spacing="8.0" GridPane.columnIndex="0" prefHeight="140.0" styleClass="stat-card, stat-card-navy">
                        <Label text="Total Reservas" styleClass="stat-label"/>
                        <Label fx:id="totalReservasLabel" text="156" styleClass="stat-value"/>
                    </VBox>
                    
                    <!-- Stat 2: Activas -->
                    <VBox spacing="8.0" GridPane.columnIndex="1" prefHeight="140.0" styleClass="stat-card, stat-card-navy">
                        <Label text="Activas" styleClass="stat-label"/>
                        <Label fx:id="activasLabel" text="23" styleClass="stat-value"/>
                    </VBox>
                    
                    <!-- Stat 3: Completadas -->
                    <VBox spacing="8.0" GridPane.columnIndex="2" prefHeight="140.0" styleClass="card-stat"
                          style="-fx-background-color: linear-gradient(to bottom right, #002855, #003d7a); -fx-background-radius: 12px; -fx-padding: 24px;">
                        <Label text="Completadas" styleClass="stat-label"/>
                        <Label fx:id="completadasLabel" text="128" styleClass="stat-value"/>
                    </VBox>
                    
                    <!-- Stat 4: Espacios Disponibles -->
                    <VBox spacing="8.0" GridPane.columnIndex="3" prefHeight="140.0" styleClass="card-stat"
                          style="-fx-background-color: linear-gradient(to bottom right, #002855, #003d7a); -fx-background-radius: 12px; -fx-padding: 24px;">
                        <Label text="Espacios Disponibles" styleClass="stat-label"/>
                        <Label fx:id="espaciosDisponiblesLabel" text="42" styleClass="stat-value"/>
                    </VBox>
                </GridPane>
                
                <!-- Próximas Reservas Section -->
                <VBox spacing="24.0">
                    <!-- Header -->
                    <HBox alignment="CENTER_LEFT" spacing="16.0">
                        <Label text="Próximas Reservas" 
                               style="-fx-font-family: 'Inter'; -fx-font-size: 24px; -fx-font-weight: 600; -fx-text-fill: #0f172a;">
                        </Label>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Button fx:id="verTodasReservas" text="Ver todas →" 
                                onAction="#navigateToMisReservas"
                                style="-fx-background-color: transparent; -fx-text-fill: #0066cc; -fx-font-family: 'Inter'; -fx-font-size: 14px; -fx-cursor: hand;">
                        </Button>
                    </HBox>
                    
                    <!-- Reservas List (placeholder - will be populated dynamically) -->
                    <VBox fx:id="proximasReservasContainer" spacing="16.0">
                        <!-- Reserva Card 1 -->
                        <HBox alignment="CENTER_LEFT" spacing="20.0" prefHeight="100.0" styleClass="card"
                              style="-fx-background-color: white; -fx-background-radius: 12px; -fx-border-color: #e2e8f0; -fx-border-radius: 12px; -fx-padding: 20px;">
                            <VBox spacing="4.0" HBox.hgrow="ALWAYS">
                                <Label text="Salón de Eventos Municipal" 
                                       style="-fx-font-family: 'Inter'; -fx-font-size: 18px; -fx-font-weight: 600; -fx-text-fill: #0f172a;">
                                </Label>
                                <Label text="📅 25 de Octubre, 2025 • 🕐 14:00 - 18:00" 
                                       style="-fx-font-family: 'Inter'; -fx-font-size: 14px; -fx-text-fill: #64748b;">
                                </Label>
                            </VBox>
                            <Label text="Confirmada" styleClass="badge-success"
                                   style="-fx-background-color: #d1fae5; -fx-text-fill: #065f46; -fx-background-radius: 9999px; -fx-padding: 4px 12px;">
                            </Label>
                        </HBox>
                    </VBox>
                </VBox>
                
                <!-- Acciones Rápidas Section -->
                <VBox spacing="24.0">
                    <Label text="Acciones Rápidas" 
                           style="-fx-font-family: 'Inter'; -fx-font-size: 24px; -fx-font-weight: 600; -fx-text-fill: #0f172a;">
                    </Label>
                    
                    <GridPane hgap="24.0" vgap="24.0">
                        <columnConstraints>
                            <ColumnConstraints percentWidth="33.33"/>
                            <ColumnConstraints percentWidth="33.33"/>
                            <ColumnConstraints percentWidth="33.33"/>
                        </columnConstraints>
                        
                        <!-- Action 1: Nueva Reserva -->
                        <VBox alignment="CENTER" spacing="12.0" GridPane.columnIndex="0" prefHeight="160.0"
                              style="-fx-background-color: #f8fafc; -fx-border-color: #e2e8f0; -fx-border-width: 1px; -fx-border-radius: 12px; -fx-background-radius: 12px; -fx-padding: 24px; -fx-cursor: hand;"
                              onMouseClicked="#handleNuevaReserva">
                            <Label text="➕" style="-fx-font-size: 48px;">
                            </Label>
                            <Label text="Nueva Reserva" 
                                   style="-fx-font-family: 'Inter'; -fx-font-size: 18px; -fx-font-weight: 600; -fx-text-fill: #0f172a;">
                            </Label>
                            <Label text="Reservar un espacio" 
                                   style="-fx-font-family: 'Inter'; -fx-font-size: 14px; -fx-text-fill: #64748b;">
                            </Label>
                        </VBox>
                        
                        <!-- Action 2: Ver Espacios -->
                        <VBox alignment="CENTER" spacing="12.0" GridPane.columnIndex="1" prefHeight="160.0"
                              style="-fx-background-color: #f8fafc; -fx-border-color: #e2e8f0; -fx-border-width: 1px; -fx-border-radius: 12px; -fx-background-radius: 12px; -fx-padding: 24px; -fx-cursor: hand;"
                              onMouseClicked="#navigateToEspacios">
                            <Label text="🏛️" style="-fx-font-size: 48px;">
                            </Label>
                            <Label text="Ver Espacios" 
                                   style="-fx-font-family: 'Inter'; -fx-font-size: 18px; -fx-font-weight: 600; -fx-text-fill: #0f172a;">
                            </Label>
                            <Label text="Explorar espacios disponibles" 
                                   style="-fx-font-family: 'Inter'; -fx-font-size: 14px; -fx-text-fill: #64748b;">
                            </Label>
                        </VBox>
                        
                        <!-- Action 3: Reportes (Admin only) -->
                        <VBox alignment="CENTER" spacing="12.0" GridPane.columnIndex="2" prefHeight="160.0" fx:id="reportesAction"
                              style="-fx-background-color: #f8fafc; -fx-border-color: #e2e8f0; -fx-border-width: 1px; -fx-border-radius: 12px; -fx-background-radius: 12px; -fx-padding: 24px; -fx-cursor: hand;"
                              onMouseClicked="#navigateToReportes">
                            <Label text="📊" style="-fx-font-size: 48px;">
                            </Label>
                            <Label text="Reportes" 
                                   style="-fx-font-family: 'Inter'; -fx-font-size: 18px; -fx-font-weight: 600; -fx-text-fill: #0f172a;">
                            </Label>
                            <Label text="Ver estadísticas" 
                                   style="-fx-font-family: 'Inter'; -fx-font-size: 14px; -fx-text-fill: #64748b;">
                            </Label>
                        </VBox>
                    </GridPane>
                </VBox>
            </VBox>
        </ScrollPane>
    </center>
    
</BorderPane>
