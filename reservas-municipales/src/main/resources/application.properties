spring.application.name=reservas-municipales

# Datasource (overridable via env vars)
spring.datasource.url=${SPRING_DATASOURCE_URL:jdbc:postgresql://localhost:5432/reservas}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME:postgres}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD:postgres}
spring.datasource.driver-class-name=org.postgresql.Driver

# JPA
spring.jpa.hibernate.ddl-auto=none
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false

# Use snake_case naming
spring.jpa.hibernate.naming.physical-strategy=org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl

# Force PostgreSQL dialect to avoid metadata lookup issues
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect

# ==========================================
# Weather API Configuration
# ==========================================
weather.api.url=${WEATHER_API_URL:https://api.openweathermap.org/data/3.0}
weather.api.key=${WEATHER_API_KEY:fe9e527f3bfe3183bca689f980addd09}
weather.api.timeout=${WEATHER_API_TIMEOUT:2000}
weather.api.max-retries=${WEATHER_API_MAX_RETRIES:2}
weather.api.cache-ttl=${WEATHER_API_CACHE_TTL:300}

# Cache Configuration
spring.cache.caffeine.spec=maximumSize=500,expireAfterWrite=300s
spring.cache.cache-names=weatherCache

# ==========================================
# Thymeleaf Configuration
# ==========================================
spring.thymeleaf.prefix=classpath:/templates/
spring.thymeleaf.suffix=.html
spring.thymeleaf.mode=HTML
spring.thymeleaf.encoding=UTF-8
spring.thymeleaf.cache=false

# ==========================================
# Mail Configuration
# ==========================================
spring.mail.default-encoding=UTF-8

# ==========================================
# Logging Configuration (for debugging emails)
# ==========================================
logging.level.org.springframework.mail=DEBUG
logging.level.org.thymeleaf=DEBUG
logging.level.cr.una.reservas_municipales.service.EmailService=DEBUG

# ==========================================
# Resilience4j Configuration
# ==========================================
# Retry Configuration
resilience4j.retry.instances.weatherApi.max-attempts=3
resilience4j.retry.instances.weatherApi.wait-duration=500ms
resilience4j.retry.instances.weatherApi.enable-exponential-backoff=true
resilience4j.retry.instances.weatherApi.exponential-backoff-multiplier=2

# Circuit Breaker Configuration
resilience4j.circuitbreaker.instances.weatherApi.failure-rate-threshold=50
resilience4j.circuitbreaker.instances.weatherApi.wait-duration-in-open-state=30s
resilience4j.circuitbreaker.instances.weatherApi.permitted-number-of-calls-in-half-open-state=3
resilience4j.circuitbreaker.instances.weatherApi.sliding-window-size=10
resilience4j.circuitbreaker.instances.weatherApi.sliding-window-type=COUNT_BASED

